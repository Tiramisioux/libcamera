# libcamera-hw-sync

`libcamera-hw-sync` is a small utility that generates UDP synchronisation packets for libcamera based applications. It converts pulses from an external clock source into the format understood by libcamera's sync algorithm.

## Building

Build `libcamera` as usual and then build `libcamera-hw-sync` from the same source tree. For example:

```sh
meson setup build
ninja -C build libcamera-hw-sync
sudo ninja -C build install
```

## Running

Start `libcamera-hw-sync` in its own shell window. The `--source` option selects how pulses are generated. `timer` (default) simulates a periodic pulse, `stdin` waits for the Enter key, and `gpio` listens for rising edges on a GPIO line specified by `--line`. Use `--chip` to select the `gpiochip` device if required. By default the utility targets `gpiochip4` (suitable for Raspberry PiÂ 5) but it will fall back to `gpiochip0` should `gpiochip4` not be present.

Example:

```sh
libcamera-hw-sync --source timer --fps 30
```

In another window start a libcamera application, such as `rpicam-vid`, in client sync mode:

```sh
rpicam-vid --sync client -o video.h264
```

The video application will synchronise to the pulses generated by `libcamera-hw-sync`.

When using GPIO input, the utility reports the time between pulses and warns if they deviate significantly from the requested frame duration. This helps to verify that the hardware source provides a stable signal.
